<!DOCTYPE html>
<!-- saved from url=(0062)https://wwwgseshccedutw1681688.on.drv.tw/web/minesweeper2.html -->
<html lang="zh-Hant"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆèªåœ°é›·è§£è¬éŠæˆ²</title>
	<head>
    <style>
		body {
		font-family: 'Segoe UI', Arial, sans-serif;
		display: flex;
		flex-direction: column;
		align-items: center;
		margin: 0;
		background-color: #f5f7fa;
		touch-action: pan-y;
		min-height: 100vh;
		}

		#game-container {
			text-align: center;
			margin: 20px;
			display: flex;
			flex-direction: column;
			align-items: center;
			width: 100%;
			position: relative;
			max-width: 1200px;
			padding: 20px;
			box-sizing: border-box;
		}

		/* æ–°å¢éŠæˆ²å€åŸŸåŒ…è£å®¹å™¨ */
		.game-board-wrapper {
			position: relative;
			width: 100%;
			z-index: 2;
			background-color: #f5f7fa;
			padding: 20px 0;
			margin-bottom: 20px;
			display: flex;
			flex-direction: column;
			align-items: center; /* ç¢ºä¿å…§å®¹ç½®ä¸­ */
		}

		#minefield {
			display: grid;
			grid-template-columns: repeat(10, 40px);
			gap: 4px;
			margin: 0 auto; /* ç§»é™¤ä¸Šæ–¹é‚Šè· */
			position: sticky;
			top: 20px;
			background-color: #f5f7fa;
			z-index: 2;
			padding: 15px;
			border-radius: 10px;
			box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
			width: fit-content;
			justify-self: center;
		}

		#level-indicator {
			text-align: center;
			font-size: 28px;
			font-weight: bold;
			color: #2ecc71;
			text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
			position: relative;
			z-index: 2;
			width: 100%;
			margin-bottom: 10px; /* æ¸›å°‘èˆ‡æŒ‰éˆ•çš„é–“è· */
		}
		/* æ–°å¢é‡æ–°é–‹å§‹æŒ‰éˆ•çš„å®¹å™¨ */
		.restart-button-container {
			margin: 10px 0 20px 0; /* ä¸Šä¸‹é–“è·èª¿æ•´ */
			width: 100%;
			display: flex;
			justify-content: center;
			position: relative;
			z-index: 2;
		}
		.cell {
			width: 40px;
			height: 40px;
			background-color: #e3e8ec;
			border: 2px solid #d1d8dc;
			border-radius: 8px;
			text-align: center;
			line-height: 40px;
			font-size: 16px;
			font-weight: bold;
			cursor: pointer;
			transition: all 0.2s ease;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
		}

		.cell:hover {
			transform: scale(1.05);
			box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
		}

		.cell.revealed {
			background-color: #ffffff;
			border-color: #e1e8ed;
			box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
		}

		.cell.mine {
			background-color: #ff6b6b;
			color: white;
		}

		.cell.flagged {
			background-color: #ffd93d;
			color: #444;
			border-color: #ffc107;
		}

		/* ä¿®æ”¹å•é¡Œå€åŸŸçš„æ¨£å¼ */
		#questions {
			margin: 30px 20px;
			padding: 20px;
			background-color: white;
			border-radius: 15px;
			box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
			width: 100%;
			max-width: 800px;
			position: relative;
			z-index: 1;
		}

		/* ç¢ºä¿å•é¡Œå®¹å™¨åœ¨æ²å‹•æ™‚ä¸æœƒè¦†è“‹éŠæˆ²å€åŸŸ */
		#questions-container {
			position: relative;
			z-index: 1;
		}

		.question {
			margin-bottom: 20px;
			padding: 15px;
			border-radius: 8px;
			background-color: #f8f9fa;
		}

		.answer-box {
			display: inline-block;
			width: 35px;
			height: 35px;
			border: 2px solid #3498db;
			border-radius: 6px;
			text-align: center;
			line-height: 35px;
			margin-right: 8px;
			font-size: 16px;
			background-color: white;
		}

		/* æŒ‰éˆ•æ¨£å¼èª¿æ•´ */
		#submit-btn, #restart-btn {
			padding: 12px 30px;
			font-size: 16px;
			border: none;
			border-radius: 25px;
			cursor: pointer;
			transition: all 0.3s ease;
			font-weight: bold;
			text-transform: uppercase;
			letter-spacing: 1px;
			position: relative;
			z-index: 1;
		}

		#submit-btn {
			background-color: #2ecc71;
			color: white;
			box-shadow: 0 4px 6px rgba(46, 204, 113, 0.2);
		}

		#restart-btn {
			background-color: #3498db;
			color: white;
			padding: 10px 25px; /* ç¨å¾®ç¸®å°æŒ‰éˆ•å¤§å° */
			font-size: 16px;
			border: none;
			border-radius: 25px;
			cursor: pointer;
			transition: all 0.3s ease;
			font-weight: bold;
			text-transform: uppercase;
			letter-spacing: 1px;
			box-shadow: 0 4px 6px rgba(52, 152, 219, 0.2);
		}

		#submit-btn:hover, #restart-btn:hover {
			transform: translateY(-2px);
			box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
		}

		#result {
			margin: 20px auto;
			padding: 15px 20px;
			font-size: 18px;
			font-weight:bold;
			text-align: left;
			background-color: white;
			border-radius: 10px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			max-width: 800px;
			line-height: 1.6;
			position: relative;
			z-index: 1;
		}

		.red-text {
			color: #e74c3c;
		}

		/* å¹³æ¿é©é… */
		@media screen and (max-width: 1024px) {
			#game-container {
				padding: 15px;
			}
			
			#minefield {
				grid-template-columns: repeat(8, 35px);
				gap: 3px;
			}
			
			.cell {
				width: 35px;
				height: 35px;
				font-size: 14px;
				line-height: 35px;
			}
		}

		/* æ‰‹æ©Ÿé©é… */
		@media screen and (max-width: 768px) {
			.cell {
				width: 30px;
				height: 30px;
				line-height: 30px;
				font-size: 12px;
				border-radius: 6px;
			}
			
			#result {
				font-size: 16px;
				padding: 12px 15px;
			}
		}
</style>
</head>
<body inmaintabuse="1">
     <div id="game-container">
		<h1>æˆèªè¸©åœ°é›·è§£è¬éŠæˆ²</h1>
		
		<div class="game-board-wrapper">
			<!-- é—œå¡æŒ‡ç¤ºå™¨ -->
			<div id="level-indicator">é—œå¡ 1</div>
			
			<!-- é‡æ–°é–‹å§‹æŒ‰éˆ•çš„æ–°ä½ç½® -->
			<div class="restart-button-container">
				<button id="restart-btn">é‡æ–°é–‹å§‹</button>
			</div>
			
			<!-- éŠæˆ²å€åŸŸ -->
			<div id="minefield"></div>
		</div>
		
		<!-- å•é¡Œå€åŸŸ -->
		<div id="questions">
			<div id="questions-container"></div>
		</div>
		
		<!-- æäº¤æŒ‰éˆ• -->
		<button id="submit-btn">æäº¤ç­”æ¡ˆ</button>
		
		<!-- çµæœé¡¯ç¤º -->
		<div id="result"></div>
	</div>

    <script>
        const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
        let longPressTimeout;
        let touchMoved = false; // åˆ¤æ–·è§¸æ§æ˜¯å¦ç§»å‹•ï¼Œé¿å…é•·æŒ‰èª¤è§¸
		const minefield = document.getElementById("minefield");
		const questionsContainer = document.getElementById("questions-container");
		const submitBtn = document.getElementById("submit-btn");
		const restartBtn = document.getElementById("restart-btn");
		const resultDiv = document.getElementById("result");
		const gridSize = 10;
		const idioms = [
		  { term: "å®ˆæ ªå¾…å…”", explanation: "æ¯”å–»å¦„æƒ³ä¸å‹è€Œç²ã€‚" },
		  { term: "ç•«è›‡æ·»è¶³", explanation: "æ¯”å–»å¤šæ­¤ä¸€èˆ‰ï¼Œå¼„å·§æˆæ‹™ã€‚" },
		  { term: "ç›²äººæ‘¸è±¡", explanation: "æ¯”å–»ä»¥åæ¦‚å…¨ï¼Œä¸å¾—è¦é ˜ã€‚" },
		  { term: "è‡ªç›¸çŸ›ç›¾", explanation: "æ¯”å–»èªªè©±æˆ–è¡Œäº‹å‰å¾Œä¸ä¸€è‡´ã€‚" },
		  { term: "äº•åº•ä¹‹è›™", explanation: "æ¯”å–»çœ¼ç•Œç‹¹å°ï¼Œè¦‹è­˜çŸ­æ·ºã€‚" },
		  { term: "å°ç‰›å½ˆç´", explanation: "æ¯”å–»å°ä¸æ‡‚é“ç†çš„äººè¬›é“ç†ã€‚" },
		  { term: "åˆ»èˆŸæ±‚åŠ", explanation: "æ¯”å–»æ‹˜æ³¥å›ºåŸ·ï¼Œä¸æ‡‚è®Šé€šã€‚" },
		  { term: "æ©è€³ç›œéˆ´", explanation: "æ¯”å–»è‡ªæ¬ºæ¬ºäººã€‚" },
		  { term: "æ‹”è‹—åŠ©é•·", explanation: "æ¯”å–»æ€¥æ–¼æ±‚æˆï¼Œåè€Œå£äº‹ã€‚" },
		  { term: "æœ›æ¢…æ­¢æ¸´", explanation: "æ¯”å–»ç”¨ç©ºæƒ³ä¾†å®‰æ…°è‡ªå·±ã€‚" },
		  { term: "å®ˆæœ›ç›¸åŠ©", explanation: "æ¯”å–»åœ˜çµåˆä½œï¼Œäº’ç›¸å¹«åŠ©ã€‚" },
		  { term: "é©šå¼“ä¹‹é³¥", explanation: "æ¯”å–»å—éé©šåš‡çš„äººé‡äº‹å®¹æ˜“ææ…Œã€‚" },
		  { term: "å…”æ­»ç‹æ‚²", explanation: "æ¯”å–»åŒé¡çš„æ­»äº¡æˆ–ä¸å¹¸è€Œæ„Ÿåˆ°å‚·å¿ƒã€‚" },
		  { term: "ç‹¼ç‹½ç‚ºå¥¸", explanation: "æ¯”å–»å£äººäº’ç›¸å‹¾çµå¹¹å£äº‹ã€‚" },
		  { term: "æ¯å¼“è›‡å½±", explanation: "æ¯”å–»å› ç–‘ç¥ç–‘é¬¼è€Œè‡ªé©šè‡ªæ“¾ã€‚" },
		  { term: "ä¸€ç®­é›™éµ°", explanation: "æ¯”å–»ä¸€èˆ‰å…©å¾—ã€‚" },
		  { term: "ç•«é¾é»ç›", explanation: "æ¯”å–»é»å‡ºé—œéµä½¿ä¹‹æ›´åŠ ç”Ÿå‹•ã€‚" },
		  { term: "é’å‡ºæ–¼è—", explanation: "æ¯”å–»å¾Œè¼©å‹éå‰è¼©ã€‚" },
		  { term: "ç™¾ç™¼ç™¾ä¸­", explanation: "æ¯”å–»åšäº‹æœ‰å……åˆ†æŠŠæ¡ï¼Œç¸½èƒ½æˆåŠŸã€‚" },
		  { term: "ä¸€é¼“ä½œæ°£", explanation: "æ¯”å–»è¶å‹¢è¡Œäº‹ï¼Œä¸€æ°£å‘µæˆã€‚" },
		  { term: "æœä¸‰æš®å››", explanation: "æ¯”å–»å¿ƒæ„ä¸å®šæˆ–åè¦†ç„¡å¸¸ã€‚" },
		  { term: "ä¹ç‰›ä¸€æ¯›", explanation: "æ¯”å–»å¾®ä¸è¶³é“çš„å°äº‹ã€‚" },
		  { term: "æ„šå…¬ç§»å±±", explanation: "æ¯”å–»æœ‰å …å¼·çš„æ¯…åŠ›ï¼Œä¸æ€•å›°é›£ã€‚" },
		  { term: "æ°´è½çŸ³å‡º", explanation: "æ¯”å–»äº‹æƒ…çš„çœŸç›¸çµ‚æ–¼é¡¯ç¾ã€‚" },
		  { term: "å£è‹¥æ‡¸æ²³", explanation: "æ¯”å–»èƒ½è¨€å–„è¾¯ã€‚" },
		  { term: "èé›èµ·èˆ", explanation: "æ¯”å–»åŠæ™‚å¥®ç™¼åŠªåŠ›ã€‚" },
		  { term: "ç´™ä¸Šè«‡å…µ", explanation: "æ¯”å–»ç©ºè«‡ç†è«–è€Œç„¡å¯¦éš›è¡Œå‹•ã€‚" },
		  { term: "ç•«é¤…å……é¥‘", explanation: "æ¯”å–»å¾’æœ‰è™›åï¼Œç„¡æ³•æ»¿è¶³å¯¦éš›éœ€è¦ã€‚" },
		  { term: "äº¡ç¾Šè£œç‰¢", explanation: "æ¯”å–»å‡ºç¾å•é¡Œå¾ŒåŠæ™‚è£œæ•‘ã€‚" },
		  { term: "ä¸€ç›®åè¡Œ", explanation: "æ¯”å–»çœ‹æ›¸æ¥µå¿«ã€‚" },
		  { term: "é·¸èšŒç›¸çˆ­", explanation: "æ¯”å–»å…©æ–¹çˆ­åŸ·ï¼Œç¬¬ä¸‰æ–¹å¾—åˆ©ã€‚" },
		  { term: "æ‹”å±±æ‰›é¼", explanation: "æ¯”å–»åŠ›å¤§ç„¡çª®æˆ–æ°£å‹¢é›„å‰ã€‚" },
		  { term: "æŠ«èŠæ–¬æ£˜", explanation: "æ¯”å–»å…‹æœé‡é‡å›°é›£ï¼Œé–‹é—¢é“è·¯ã€‚" },
		  { term: "ä¸ç ´ä¸ç«‹", explanation: "æ¯”å–»å¿…é ˆå¾¹åº•æ‰“ç ´åŸæœ‰çš„æŸç¸›ï¼Œæ‰èƒ½å‰µæ–°ã€‚" },
		  { term: "æ»„æµ·æ¡‘ç”°", explanation: "æ¯”å–»ä¸–äº‹è®ŠåŒ–å¾ˆå¤§ã€‚" },
		  { term: "å…«é¢ç²ç“", explanation: "æ¯”å–»ç‚ºäººè™•äº‹åœ“æ»‘ï¼Œé¢é¢ä¿±åˆ°ã€‚" },
		  { term: "å››é¢æ¥šæ­Œ", explanation: "æ¯”å–»å­¤ç«‹ç„¡æ´ï¼Œå››é¢å—æ•µã€‚" },
		  { term: "é©šå¤©å‹•åœ°", explanation: "å½¢å®¹è²å‹¢æ¥µå¤§æˆ–å½±éŸ¿æ·±é ã€‚" },
		  { term: "æ»¾ç“œçˆ›ç†Ÿ", explanation: "æ¯”å–»å°äº‹ç‰©éå¸¸ç†Ÿç·´ã€‚" },
		  { term: "åè½å­«å±±", explanation: "æ¯”å–»è€ƒè©¦è½æ¦œæˆ–é¸æ‹”æœªè¢«éŒ„å–ã€‚" },
		  { term: "æ——é¼“ç›¸ç•¶", explanation: "æ¯”å–»å¯¦åŠ›ç›¸ç•¶ï¼Œé›£åˆ†é«˜ä¸‹ã€‚" },
		  { term: "å¾·é«˜æœ›é‡", explanation: "å½¢å®¹é“å¾·é«˜å°šï¼Œæ¥µå—æ•¬é‡ã€‚" },
		  { term: "è«‡ç¬‘é¢¨ç”Ÿ", explanation: "å½¢å®¹è«‡è©±æ™‚èˆˆè‡´é«˜æ˜‚ï¼Œæ°£æ°›ç†±çƒˆã€‚" },
		  { term: "æ°£å®‡è»’æ˜‚", explanation: "å½¢å®¹äººçš„ç²¾ç¥å……æ²›ï¼Œæ°£åº¦ä¸å‡¡ã€‚" },
		  { term: "æ‰è¥Ÿè¦‹è‚˜", explanation: "æ¯”å–»é¡§æ­¤å¤±å½¼ï¼Œçª®æ–¼æ‡‰ä»˜ã€‚" },
		  { term: "ä¸å¯’è€Œæ…„", explanation: "å½¢å®¹éå¸¸å®³æ€•ï¼Œæ¸¾èº«ç™¼æŠ–ã€‚" },
		  { term: "å”¾æ‰‹å¯å¾—", explanation: "å½¢å®¹äº‹æƒ…æ¥µå®¹æ˜“è¾¦æˆã€‚" },
		  { term: "é›£å…„é›£å¼Ÿ", explanation: "æ¯”å–»è™•å¢ƒæˆ–é­é‡ç›¸ä¼¼çš„äººã€‚" },
		  { term: "ç„¡ä¸­ç”Ÿæœ‰", explanation: "æ¯”å–»æ†‘ç©ºæé€ äº‹ç‰©ã€‚" },
		  { term: "è³è‡‚ç•¶è»Š", explanation: "æ¯”å–»ä¸è‡ªé‡åŠ›çš„è¡Œç‚ºã€‚" },
		  { term: "é€€é¿ä¸‰èˆ", explanation: "æ¯”å–»å¿è®“ä»¥é¿å…è¡çªã€‚" },
		  { term: "å¤©è¡£ç„¡ç¸«", explanation: "æ¯”å–»åšäº‹å®Œç¾ï¼Œæ¯«ç„¡ç¼ºé™·ã€‚" },
		  { term: "é¶´ç«‹é›ç¾¤", explanation: "æ¯”å–»æ‰èƒ½æˆ–å„€è¡¨è¶…ç¾¤å‡ºçœ¾ã€‚" },
		  { term: "æ¯æ°´è»Šè–ª", explanation: "æ¯”å–»åŠ›é‡å¾®è–„ï¼Œç„¡æ¿Ÿæ–¼äº‹ã€‚" },
		  { term: "é †æ‰‹ç‰½ç¾Š", explanation: "æ¯”å–»ä¹˜æ©Ÿè¡Œäº‹ï¼Œé †ä¾¿å–åˆ©ã€‚" },
		  { term: "æ¨‚æ¥µç”Ÿæ‚²", explanation: "æ¯”å–»æ¨‚éé ­å®¹æ˜“å¼•ç™¼ä¸å¹¸ã€‚" },
		  { term: "å¡ç¿å¤±é¦¬", explanation: "æ¯”å–»ç¦ç¦ç›¸å€šé›£ä»¥é æ–™ã€‚" },
		  { term: "é³¥ç›¡å¼“è—", explanation: "æ¯”å–»äº‹æƒ…æˆåŠŸå¾Œæ‹‹æ£„å¹«æ‰‹ã€‚" },
		  { term: "å…µä¸å­è©", explanation: "æ¯”å–»ç”¨è¨ˆè¬€å–å¾—å‹åˆ©ã€‚" },
		  { term: "åŠŸæ•—å‚æˆ", explanation: "æ¯”å–»äº‹æƒ…å°‡è¦æˆåŠŸæ™‚å¤±æ•—ã€‚" },
		  { term: "ç•«ä¸­æœ‰è©©", explanation: "æ¯”å–»ç•«é¢æ„å¢ƒæ·±é ï¼Œæ„å‘³ç„¡çª®ã€‚" },
		  { term: "é¯¨åè ¶é£Ÿ", explanation: "æ¯”å–»é€æ­¥åä½µã€‚" },
		  { term: "ç™½æ‰‹èµ·å®¶", explanation: "æ¯”å–»åœ¨ç„¡åŸºç¤çš„æƒ…æ³ä¸‹å‰µæ¥­æˆåŠŸã€‚" },
		  { term: "å”‡äº¡é½’å¯’", explanation: "æ¯”å–»é—œä¿‚å¯†åˆ‡ï¼Œç¦ç¦ç›¸é—œã€‚" },
		  { term: "é³³æ¯›éºŸè§’", explanation: "æ¯”å–»ç¨€å°‘çè²´çš„äººæˆ–ç‰©ã€‚" },
		  { term: "è¿‘æ°´æ¨“è‡º", explanation: "æ¯”å–»å å¾—åœ°åˆ©ä¹‹ä¾¿ã€‚" },
		  { term: "ç²¾ç›Šæ±‚ç²¾", explanation: "æ¯”å–»åŠ›æ±‚æ›´å®Œç¾ã€‚" },
		  { term: "ä¸€é³´é©šäºº", explanation: "æ¯”å–»å¹³æ™‚ä¸é¡¯éœ²ï¼Œçªç„¶ä»¤äººéœ‡é©šã€‚" },
		  { term: "è½äº•ä¸‹çŸ³", explanation: "æ¯”å–»ä¹˜äººå±é›£æ™‚åŠ ä»¥é™·å®³ã€‚" }
		];



		const levelConfig = [
			{ level: 1, idiomCount: 2 },
			{ level: 2, idiomCount: 2 },
			{ level: 3, idiomCount: 3 },
			{ level: 4, idiomCount: 3 },
			{ level: 5, idiomCount: 4 }
		];
		let currentLevel = 0;
		let selectedIdioms = [];
		let grid = [];
		let flaggedCount = 0;
		let correctFlaggedCount = 0;
		let gameOver = false;
		let usedIdioms = []; // å·²ä½¿ç”¨çš„æˆèª


		// åˆå§‹åŒ–éŠæˆ²
		function startGame() {
			currentLevel = 0;
			nextLevel();
		}

		
		// é–‹å§‹ä¸‹ä¸€é—œ
		function nextLevel() {
			if (currentLevel >= levelConfig.length) {
				// æ‰€æœ‰é—œå¡å®Œæˆ
				resultDiv.textContent = "æ­å–œï¼æ‚¨å·²å®Œæˆæ‰€æœ‰é—œå¡ï¼æŒ‘æˆ°æˆåŠŸï¼";
				resultDiv.style.color = "green";

				// éš±è—é€å‡ºæŒ‰éˆ•
				submitBtn.style.display = "none";

				// æ¸…ç©ºåœ°åœ–å’Œé¡Œç›®
				minefield.innerHTML = "";
				questionsContainer.innerHTML = "";

				// é¡¯ç¤ºéŠæˆ²çµæŸæç¤º
				document.getElementById("level-indicator").textContent = "éŠæˆ²çµæŸ";
				return;
			}

			// è¨­ç½®ç•¶å‰é—œå¡
			const { level, idiomCount } = levelConfig[currentLevel];
			currentLevel++;

			// æ›´æ–°é—œå¡æç¤º
			const levelIndicator = document.getElementById("level-indicator");
			levelIndicator.textContent = `ç›®å‰æ˜¯ç¬¬ ${currentLevel} é—œ`;

			resultDiv.innerHTML = "<span class='red-text'>éŠæˆ²èªªæ˜ï¼š<br>1.æœ¬éŠæˆ²æ˜¯å°‡å‚³çµ±çš„åœ°é›·æ”¹ç‚ºæˆèªå–®å­—ã€‚<br>2.è«‹æ ¹æ“šæç¤ºçš„æ•¸å­—ï¼Œæ‰¾å‡ºæ‰€æœ‰çš„åœ°é›·ä½ç½®ä¸”é ˆæ¨™ç¤ºå‡ºä¾†æ‰æœƒé¡¯ç¤ºæ‰€æœ‰æç¤ºçš„æˆèªã€‚<br>3.æŒ‰å³éµå¯æ¨™ç¤ºåœ°é›·ï¼Œå¹³æ¿å‰‡ç‚ºé•·æŒ‰è¶…é0.5ç§’ç‚ºæ¨™ç¤ºåœ°é›·ã€‚<br>4.æœ€å¾Œè«‹æ ¹æ“šæç¤ºçš„æˆèªè¼¸å…¥ç­”æ¡ˆæ¬„é€å‡ºï¼Œå…¨éƒ¨æ­£ç¢ºæ‰æœƒé€²å…¥ä¸‹ä¸€é—œã€‚</span>";
			resultDiv.style.color = "black";

			// éš¨æ©Ÿé¸å–æˆèª
			selectedIdioms = selectRandomIdioms(idiomCount); // ä½¿ç”¨ä¸é‡è¤‡çš„éš¨æ©ŸæŠ½é¡Œé‚è¼¯
			createGrid();
		}

		function selectRandomIdioms(count) {
			const availableIdioms = idioms.filter(idiom => !usedIdioms.includes(idiom.term));
			const selected = shuffleArray(availableIdioms).slice(0, count);
			usedIdioms.push(...selected.map(idiom => idiom.term)); // è¨˜éŒ„å·²ä½¿ç”¨çš„æˆèª
			return selected;
		}

		// éš¨æ©Ÿæ‰“äº‚æ•¸çµ„
		function shuffleArray(array) {
			return array.sort(() => Math.random() - 0.5);
		}



		// å‰µå»ºéŠæˆ²ç¶²æ ¼
		function createGrid() {
			minefield.innerHTML = "";
			grid = Array(gridSize)
				.fill()
				.map(() => Array(gridSize).fill(null));
			minefield.style.gridTemplateColumns = `repeat(${gridSize}, 40px)`;

			const characters = selectedIdioms.flatMap(idiom => idiom.term.split(""));
			characters.sort(() => Math.random() - 0.5);

			const mineCount = characters.length;
			const minePositions = generateRandomPositions(mineCount, gridSize * gridSize);
			let index = 0;

			for (let row = 0; row < gridSize; row++) {
				for (let col = 0; col < gridSize; col++) {
					const cell = document.createElement("div");
					cell.className = "cell";

					if (minePositions.includes(index)) {
						grid[row][col] = {
							mine: true,
							char: characters.length ? characters.pop() : "",
							revealed: false,
							flagged: false,
							element: cell
						};
					} else {
						grid[row][col] = {
							mine: false,
							char: "",
							count: 0,
							revealed: false,
							flagged: false,
							element: cell
						};
					}

					cell.dataset.row = row;
					cell.dataset.col = col;

					// è¨˜éŒ„è§¸æ§ç›¸é—œç‹€æ…‹
					let touchStartTime = 0;
					let touchEndTime = 0;
					let touchMoved = false;
					let longPressTimer = null;  // æ–°å¢è¨ˆæ™‚å™¨è®Šæ•¸

					// è§¸æ§é–‹å§‹
					cell.addEventListener('touchstart', (e) => {
						e.preventDefault();
						touchStartTime = Date.now();
						touchMoved = false;
						
						// è¨­ç½®é•·æŒ‰è¨ˆæ™‚å™¨
						longPressTimer = setTimeout(() => {
							if (!touchMoved) {
								toggleFlag(cell, row, col);
							}
						}, 500);  // 0.5ç§’
					});

					// è§¸æ§ç§»å‹•
					cell.addEventListener('touchmove', (e) => {
						e.preventDefault();
						touchMoved = true;
						clearTimeout(longPressTimer);  // ç§»å‹•æ™‚æ¸…é™¤è¨ˆæ™‚å™¨
					});

					// è§¸æ§çµæŸ
					cell.addEventListener('touchend', (e) => {
						e.preventDefault();
						touchEndTime = Date.now();
						clearTimeout(longPressTimer);  // çµæŸæ™‚æ¸…é™¤è¨ˆæ™‚å™¨
						
						if (!touchMoved) {
							// ç´”ç²¹çš„é»æ“Šï¼ˆå°æ–¼ 500 æ¯«ç§’ï¼‰
							if (touchEndTime - touchStartTime < 500) {
								handleMineClick(cell, row, col);
							}
						}
					});

					// ç‚ºéè§¸æ§è¨­å‚™æ·»åŠ æ»‘é¼ äº‹ä»¶
					if (!isTouchDevice) {
						cell.addEventListener("click", () => handleMineClick(cell, row, col));
						cell.addEventListener("contextmenu", (e) => {
							e.preventDefault();
							toggleFlag(cell, row, col);
						});
					}

					minefield.appendChild(cell);
					index++;
				}
			}

			calculateNumbers();
			createQuestions();
			submitBtn.style.display = "none";
			gameOver = false;
			flaggedCount = 0;
			correctFlaggedCount = 0;
		}

		// é˜²æ­¢æ•´å€‹é é¢æ»¾å‹•
		document.body.addEventListener('touchmove', function(e) {
			if (e.target.classList.contains('cell')) {
				e.preventDefault();
			}
		}, { passive: false });

        
		// æ¨™è¨˜æˆ–å–æ¶ˆæ¨™è¨˜åœ°é›·
		function toggleFlag(cell, row, col) {
			const gridCell = grid[row][col];
			if (gridCell.revealed || gameOver) return;

			if (gridCell.flagged) {
				// å–æ¶ˆæ¨™è¨˜
				gridCell.flagged = false;
				cell.classList.remove("flagged");
				cell.textContent = "";
				flaggedCount--;
				if (gridCell.mine) correctFlaggedCount--;
			} else {
				// æ¨™è¨˜åœ°é›·
				gridCell.flagged = true;
				cell.classList.add("flagged");
				cell.textContent = "ğŸš©";
				flaggedCount++;
				if (gridCell.mine) correctFlaggedCount++;
			}

			// æª¢æŸ¥æ˜¯å¦æ‰€æœ‰åœ°é›·éƒ½è¢«æ­£ç¢ºæ¨™è¨˜
			if (correctFlaggedCount === selectedIdioms.flatMap(idiom => idiom.term.split("")).length &&
				flaggedCount === correctFlaggedCount) {
				gameOver = true;
				revealAllIdioms();
				submitBtn.style.display = "block";
				resultDiv.textContent = "æ­å–œï¼æ‚¨å·²æ‰¾å‡ºæ‰€æœ‰å­—ï¼è«‹æ ¹æ“šæ‰¾åˆ°çš„å­—å®Œæˆä¸‹æ–¹çš„æˆèªã€‚";
				resultDiv.style.color = "green";
			}
		}
		
		// é¡¯ç¤ºæ‰€æœ‰åœ°é›·æ ¼ä¸­çš„æˆèªå–®å­—
		function revealAllIdioms() {
			grid.flat().forEach(cell => {
				if (cell.mine) {
					cell.element.textContent = cell.char; // é¡¯ç¤ºåœ°é›·æ ¼çš„æˆèªå–®å­—
					cell.element.classList.add("revealed");
				}
			});
		}

		// è™•ç†åœ°é›·æ ¼é»æ“Š
		function handleMineClick(cell, row, col) {
			if (gameOver || grid[row][col].flagged) return;

			const gridCell = grid[row][col];

			if (gridCell.mine) {
				// è¸©åˆ°åœ°é›·
				cell.classList.add("mine");
				cell.textContent = gridCell.char;
				gridCell.revealed = true;
				gameOver = true;
				revealAllMines();
				setTimeout(() => {
					alert("éŠæˆ²çµæŸï¼æ‚¨è¸©åˆ°äº†åœ°é›·ï¼");
					createGrid(); // é‡æ–°é–‹å§‹éŠæˆ²
				}, 100);
			} else {
				revealCell(cell, row, col);
			}
		}

		// é¡¯ç¤ºæ ¼å­
		function revealCell(cell, row, col) {
			const gridCell = grid[row][col];
			if (!gridCell.revealed) {
				gridCell.revealed = true;
				cell.classList.add("revealed");
				if (gridCell.count > 0) {
					cell.textContent = gridCell.count;
				} else {
					cell.textContent = "";
					revealAdjacentCells(row, col);
				}
			}
		}

		// é¡¯ç¤ºç›¸é„°æ ¼å­
		function revealAdjacentCells(row, col) {
			const directions = [
				[-1, -1], [-1, 0], [-1, 1],
				[0, -1],         [0, 1],
				[1, -1], [1, 0], [1, 1]
			];

			directions.forEach(([dx, dy]) => {
				const newRow = row + dx;
				const newCol = col + dy;
				if (newRow >= 0 && newRow < gridSize && newCol >= 0 && newCol < gridSize) {
					const newCell = grid[newRow][newCol];
					const cellElem = minefield.querySelector(`.cell[data-row="${newRow}"][data-col="${newCol}"]`);
					if (!newCell.revealed && !newCell.mine && !newCell.flagged) {
						revealCell(cellElem, newRow, newCol);
					}
				}
			});
		}

		// é¡¯ç¤ºæ‰€æœ‰åœ°é›·
		function revealAllMines() {
			grid.flat().forEach(cell => {
				if (cell.mine && !cell.flagged) {
					cell.element.classList.add("mine");
					cell.element.textContent = cell.char;
				}
			});
		}

		
		// é¡¯ç¤ºå¡«ç©ºé¡Œ
		function createQuestions() {
			questionsContainer.innerHTML = "";
			selectedIdioms.forEach((idiom, index) => {
				const questionDiv = document.createElement("div");
				questionDiv.className = "question";
				questionDiv.innerHTML = `
					<label>ç¬¬ ${index + 1} é¡Œï¼š${idiom.explanation}</label>
				`;
				const answerBoxes = document.createElement("div");
				answerBoxes.className = "answer-boxes";

				for (let i = 0; i < idiom.term.length; i++) {
					const box = document.createElement("input");
					box.className = "answer-box";
					box.maxLength = 1;
					box.dataset.index = `${index}-${i}`;
					answerBoxes.appendChild(box);
				}

				questionDiv.appendChild(answerBoxes);
				questionsContainer.appendChild(questionDiv);
			});
		}

		// è¨ˆç®—æ¯å€‹æ ¼å­å‘¨åœçš„åœ°é›·æ•¸é‡
		function calculateNumbers() {
			const directions = [
				[-1, -1], [-1, 0], [-1, 1],
				[0, -1],         [0, 1],
				[1, -1], [1, 0], [1, 1]
			];

			for (let row = 0; row < gridSize; row++) {
				for (let col = 0; col < gridSize; col++) {
					if (grid[row][col].mine) continue;

					let count = 0;
					directions.forEach(([dx, dy]) => {
						const newRow = row + dx;
						const newCol = col + dy;
						if (newRow >= 0 && newRow < gridSize && newCol >= 0 && newCol < gridSize) {
							if (grid[newRow][newCol].mine) count++;
						}
					});
					grid[row][col].count = count;
				}
			}
		}

		// ç”Ÿæˆéš¨æ©Ÿçš„åœ°é›·ä½ç½®
		function generateRandomPositions(count, total) {
			const positions = new Set();
			while (positions.size < count) {
				positions.add(Math.floor(Math.random() * total));
			}
			return Array.from(positions);
		}


		// éš¨æ©Ÿæ‰“äº‚æ•¸çµ„
		function shuffleArray(array) {
			return array.sort(() => Math.random() - 0.5);
		}

		// ä¿®æ”¹æäº¤é‚è¼¯ï¼Œå®Œæˆå¾Œè‡ªå‹•é€²å…¥ä¸‹ä¸€é—œï¼Œä¸¦åˆ¤æ–·æ˜¯å¦ç‚ºæœ€å¾Œä¸€é—œï¼Œè‹¥æ˜¯å‰‡é¡¯ç¤ºï¼šæ­å–œï¼æ‚¨å·²å®Œæˆæ‰€æœ‰é—œå¡ï¼æŒ‘æˆ°æˆåŠŸï¼
		function handleSubmit() {
			const results = selectedIdioms.map((idiom, idiomIndex) => {
				const userAnswer = [];
				for (let i = 0; i < idiom.term.length; i++) {
					const box = document.querySelector(`.answer-box[data-index="${idiomIndex}-${i}"]`);
					userAnswer.push(box.value);
				}
				return {
					expected: idiom.term,
					actual: userAnswer.join(""),
					correct: idiom.term === userAnswer.join("")
				};
			});

			const allCorrect = results.every(r => r.correct);

			if (allCorrect) {
				if (currentLevel >= levelConfig.length) {
					// æœ€å¾Œä¸€é—œå®Œæˆ
					resultDiv.textContent = "æ­å–œï¼æ‚¨å·²å®Œæˆæ‰€æœ‰é—œå¡ï¼æŒ‘æˆ°æˆåŠŸï¼";
					resultDiv.style.color = "green";

					// éš±è—æäº¤æŒ‰éˆ•
					submitBtn.style.display = "none";

					// æ¸…ç©ºåœ°åœ–å’Œé¡Œç›®
					minefield.innerHTML = "";
					questionsContainer.innerHTML = "";

					// é¡¯ç¤ºéŠæˆ²çµæŸæç¤º
					document.getElementById("level-indicator").textContent = "éŠæˆ²çµæŸ";
				} else {
					// éæœ€å¾Œä¸€é—œï¼Œé€²å…¥ä¸‹ä¸€é—œ
					resultDiv.textContent = "æ­å–œï¼è©²é—œå¡å®Œæˆï¼Œé€²å…¥ä¸‹ä¸€é—œï¼";
					resultDiv.style.color = "green";
					nextLevel();
				}
			} else {
				let message = "é‚„ä¸å®Œå…¨æ­£ç¢ºï¼Œè«‹é‡æ–°æª¢æŸ¥ï¼š\n";
				results.forEach((result, index) => {
					if (!result.correct) {
						message += `\nç¬¬ ${index + 1} é¡Œéœ€è¦ä¿®æ”¹`;
					}
				});
				resultDiv.textContent = message;
				resultDiv.style.color = "red";
			}
		}


		// åˆå§‹åŒ–éŠæˆ²
		restartBtn.addEventListener("click", startGame);
		submitBtn.addEventListener("click", handleSubmit);
		startGame();

    </script>
   </body>
   </html>